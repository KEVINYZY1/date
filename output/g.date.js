(function(e,t){String.prototype.parseToArray=function(e,t){var n=this.split(t||"|");return e?function(t,r){for(;t--;)n[t]=parseInt(n[t],e);return n}(n.length):n},String.trim||(String.prototype.trim=function(){var e=this,e=e.replace(/^\s\s*/,""),t=/\s/,n=e.length;while(t.test(e.charAt(--n)));return e.slice(0,n+1)}),String.replaceTpl||(String.prototype.replaceTpl=function(e){return this.replace(/#\{([^}]*)\}/mg,function(t,n){return t=e[n.trim()]})}),e.conf||(e.conf={}),e.G||(e.G={});var n=conf.date={days:[31,28,31,30,31,30,31,31,30,31,30,31],feast:{"1-1":"元旦节","2-14":"情人节","3-5":"雷锋日","3-8":"妇女节","3-12":"植树节","3-15":"消费日","4-1":"愚人节","5-1":"劳动节","5-4":"青年节","6-1":"儿童节","7-1":"建党节","8-1":"建军节","9-10":"教师节","10-1":"国庆节","12-24":"平安夜","12-25":"圣诞节"},lunar:{tpl:"#{y}-#{m}-#{d} 星期#{W} 农历 #{CM}#{CD} #{gy}(#{sx}) #{gm} #{gd} #{so} #{cf} #{gf}",leap:"ezc|esg|wog|gr9|15k0|16xc|1yl0|h40|ukw|gya|esg|wqe|wk0|15jk|2k45|zsw|16e8|yaq|tkg|1t2v|ei8|wj4|zp1|l00|lkw|2ces|8kg|tio|gdu|ei8|k12|1600|1aa8|lud|hxs|8kg|257n|t0g|2i8n|13rk|1600|2ld2|ztc|h40|2bas|7gw|t00|15ma|xg0|ztj|lgg|ztc|1v11|fc0|wr4|1sab|gcw|xig|1a34|l28|yhy|xu8|ew0|xr8|wog|g9s|1bvn|16xc|i1j|h40|tsg|fdh|es0|wk0|161g|15jk|1654|zsw|zvk|284m|tkg|ek0|xh0|wj4|z96|l00|lkw|yme|xuo|tio|et1|ei8|jw0|n1f|1aa8|l7c|gxs|xuo|tsl|t0g|13s0|16xg|1600|174g|n6a|h40|xx3|7gw|t00|141h|xg0|zog|10v8|y8g|gyh|exs|wq8|1unq|gc0|xf4|nys|l28|y8g|i1e|ew0|wyu|wkg|15k0|1aat|1640|hwg|nfn|tsg|ezb|es0|wk0|2jsm|15jk|163k|17ph|zvk|h5c|gxe|ek0|won|wj4|xn4|2dsl|lk0|yao".parseToArray(36),jqmap:"0|gd4|wrn|1d98|1tuh|2akm|2rfn|38g9|3plp|46vz|4o9k|55px|5n73|64o5|6m37|73fd|7kna|81qe|8io7|8zgq|9g4b|9wnk|ad3g|ath2|".parseToArray(36),jqnames:"小寒|大寒|立春|雨水|惊蛰|春分|清明|谷雨|立夏|小满|芒种|夏至|小暑|大暑|立秋|处暑|白露|秋分|寒露|霜降|立冬|小雪|大雪|冬至".parseToArray(),c1:"|一|二|三|四|五|六|七|八|九|十".parseToArray(),c2:"初|十|廿|卅|".parseToArray(),wk:"日一二三四五六",tg:"甲乙丙丁戊己庚辛壬癸",dz:"子丑寅卯辰巳午未申酉戌亥",sx:"鼠牛虎兔龙蛇马羊猴鸡狗猪",feast:{"1-1":"春节","1-15":"元宵节","5-5":"端午节","8-15":"中秋节","9-9":"重阳节","12-8":"腊八节"}},isl:{tpl:"#{IW} - #{d} من #{M} #{y} - #{id} #{IM} #{iy}",weekNames:["الأحد","الاثنين","الثلاثاء","الأربعاء","الخميس","الجمعة","السبت"],weekNames_Malay:["Ahad","Ithnin","Thulatha","Arbaa","Khams","Jumuah","Sabt"],gMonthNames:["ينانر","فبراير","مارس","ابريل","مايو","يونيو","يوليو","أغسطس","سبتمبر","أكتوبر","نوفمتر","ديسمبر"],monthNames:["محرم","صفر","ربيع الأول","ربيع الآخر","جمادى الأول","جمادى الآخر","رجب","شعبان","رمضان","شوال","ذي القعدة","ذي الحجة"],monthNames_Malay:["Muharram","Safar","Rabi'ul Awwal","Rabi'ul Akhir","Jumadal Ula","Jumadal Akhira","Rajab","Sha'ban","Ramadan","Shawwal","Dhul Qa'ada","Dhul Hijja"]}},r={isDate:function(e){return e instanceof Date&&!isNaN(e)},getDate:function(e){return!r.isDate(e)&&(e=new Date),{y:e.getFullYear(),m:e.getMonth()+1,d:e.getDate()}},format:function(e,t){t=t||new Date,e=e||"yyyy-MM-dd";var n=r.getDate(t),i={M:n.m,d:n.d,h:t.getHours(),m:t.getMinutes(),s:t.getSeconds()},s;for(var o in i)s=i[o],e=e.replace(new RegExp("("+o+"+)","g"),function(e,t){return s<10&&t.length>1?"0"+s:s});return e.replace(/(y+)/ig,function(e,t){return(n.y+"").substr(4-Math.min(4,t.length))})},getDaysByLunarMonth:function(e,t){return n.lunar.leap[e-1900]&65536>>t?30:29},getLeapMonth:function(e){return n.lunar.leap[e-1900]&15},getLeapDays:function(e){return r.getLeapMonth(e)?n.lunar.leap[e-1900]&65536?30:29:0},getDaysByMonth:function(e,t){return t==2?e%4==0&&e%100!=0||e%400==0?29:28:n.days[t-1]},getDaysByYear:function(e){for(var t=32768,i=348;t>8;t>>=1)i+=n.lunar.leap[e-1900]&t?1:0;return i+r.getLeapDays(e)},getDateBySolar:function(e,t){var r=new Date(31556925974.7*(e-1900)+n.lunar.jqmap[t]*6e4+Date.UTC(1900,0,6,2,5));return{m:r.getUTCMonth()+1,d:r.getUTCDate()}},getFeast:function(e,t,i,s){var o=(i?n.lunar.feast:n.feast)[e+"-"+t]||"";return i&&s&&e==12&&r.getDaysByLunarMonth(s,12)==t&&(o="除夕"),o},getSolar:function(e,t,i){var s=n.lunar.jqnames,o=s.length,u;while(o--){u=r.getDateBySolar(e,o);if(u.m==t&&u.d==i)return s[o]}return""},cyclical:function(e){return n.lunar.tg.charAt(e%10)+n.lunar.dz.charAt(e%12)},toLunar:function(e,t,i){var s=1900,o=0,u=(new Date(e,t-1,i)-new Date(1900,0,31))/864e5,a=r.getLeapMonth(e),f=!1,l;for(;s<2050&&u>0;s++)o=r.getDaysByYear(s),u-=o;u<0&&(u+=o,s--),l=s;for(s=1;s<13&&u>0;s++)a>0&&s==a+1&&f===!1?(--s,f=!0,o=r.getLeapDays(l)):o=r.getDaysByLunarMonth(l,s),f==1&&s==a+1&&(f=!1),u-=o;return u==0&&a>0&&s==a+1&&!f&&--s,u<0&&(u+=o,--s),u==0&&(f=s==a),u+=1,{cy:e-(t<s?1:0),cm:s,cd:u,CM:(f?"闰":"")+((s>9?"十":"")+n.lunar.c1[s%10]).replace("十二","腊").replace(/^一/,"正")+"月",CD:{10:"初十",20:"二十",30:"三十"}[u]||n.lunar.c2[Math.floor(u/10)]+n.lunar.c1[u%10],isleap:f}},toGz:function(e,t,n){var i=r.getDateBySolar,s=r.cyclical;return t-=1,{gy:t>=2||t==1&&n>=i(e,2).d?s(e-1864):s(e-1865),gm:n>=i(e,t*2).d?s((e-1900)*12+t+13):s((e-1900)*12+t+12),gd:s(Date.UTC(e,t,1,0,0,0,0)/864e5+25576+n)}},toSx:function(e,t,i){return n.lunar.sx.charAt((r.toLunar(e,t,i).cy-4)%12)},formatLunar:function(e,t,i){var s=r.toGz(e,t,i),o=r.toLunar(e,t,i),u=(new Date(e,t-1,i)).getDay();return{y:e,m:t,d:i,w:u,W:n.lunar.wk.charAt(u),cm:o.cm,cd:o.cd,CM:o.CM,CD:o.CD,gy:s.gy+"年",gm:s.gm+"月",gd:s.gd+"日",so:r.getSolar(e,t,i),cf:r.getFeast(o.cm,o.cd,1,o.cy),gf:r.getFeast(t,i),sx:n.lunar.sx.charAt((o.cy-4)%12),isleap:o.isleap}},lunarTpl:function(e,t,i,s){if(arguments.length<4&&typeof i!="number"){var o=r.isDate(e),u=o?r.getDate(e):r.getDate();o&&(s=t),typeof e=="string"&&(s=e),e=u.y,t=u.m,i=u.d}return(s||n.lunar.tpl).replaceTpl(r.formatLunar(e,t,i))},toIsl:function(e,t,n){var r=e,i=t,s=n;i<3&&(r-=1,i+=12);var o=Math.floor(r/100),u=2-o+Math.floor(o/4),a,f,l,c,h;r<1583&&(u=0),r==1582&&(i>10&&(u=-10),i==10&&(u=0,s>4&&(u=-10))),a=Math.floor(365.25*(r+4716))+Math.floor(30.6001*(i+1))+s+u-1524,u=0,a>2299160&&(o=Math.floor((a-1867216.25)/36524.25),u=1+o-Math.floor(o/4)),f=a+u+1524,l=Math.floor((f-122.1)/365.25),c=Math.floor(365.25*l),h=Math.floor((f-c)/30.6001),s=f-c-Math.floor(30.6001*h),i=h-1,h>13&&(l+=1,i=h-13),r=l-4716;var p=((a+1)%7+7)%7+1,d=10631/30,v=1948084,m=1948085,g=.1335,y=a-v,b=Math.floor(y/10631),w,E,S,x;return y-=10631*b,w=Math.floor((y-g)/d),E=30*b+w,y-=Math.floor(w*d+g),S=Math.floor((y+28.5001)/29.5),S==13&&(S=12),x=y-Math.floor(29.5001*S-29),{iy:E,im:S,id:x,iw:p,jd:a-1}},formatIsl:function(e,t,i){var s=r.toIsl(e,t,i),o=n.isl,u=s.iw,a=s.im;return{y:e,m:t,d:i,iy:s.iy,im:a,id:s.id,iw:u,jd:s.jd,M:o.gMonthNames[t-1],IW:o.weekNames[u-1],MW:o.weekNames_Malay[u-1],IM:o.monthNames[a-1],MM:o.monthNames_Malay[a-1]}},islTpl:function(e,t,i,s){if(arguments.length<4&&typeof i!="number"){var o=r.isDate(e),u=o?r.getDate(e):r.getDate();o&&(s=t),typeof e=="string"&&(s=e),e=u.y,t=u.m,i=u.d}return(s||n.isl.tpl).replaceTpl(r.formatIsl(e,t,i))},debug:function(e,t){var n=0,r=G.date.getDaysByMonth(e,t);for(;n<r;n++)console.log(G.date.lunarTpl(e,t,n+1))}};G.date=r})(window);